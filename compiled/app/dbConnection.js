'use strict';

var knex = require('knex')({
  client: 'mysql',
  connection: {
    host: '127.0.0.1',
    user: 'root',
    password: '12345',
    database: 'MainDatabase',
    charset: 'utf8'

  }

  // connection: {
  //   host     : 'us-cdbr-iron-east-04.cleardb.net',
  //   user     : 'b41928aa9d6e3c',
  //   password : '5a72009f',
  //   database : 'heroku_75e4ff295c2758d'
  // }
});

var db = require('bookshelf')(knex);

db.knex.schema.hasTable('movies').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('movies', function (movie) {
      movie.integer('id').primary();
      movie.string('title', 255);
      movie.string('genre', 255);
      movie.string('poster', 255);
      movie.string('release_date', 255);
      movie.string('description', 255);
      movie.integer('imdbRating');
    }).raw('ALTER TABLE movies ADD FULLTEXT (title)').then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('ratings').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('ratings', function (rating) {
      rating.increments('id').primary();
      rating.integer('score');
      rating.integer('movieid');
      rating.integer('userid');
      rating.string('review', 255);
      rating.timestamps();
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('users').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('users', function (user) {
      user.increments('id').primary();
      user.string('username', 255).unique();
      user.string('password', 255);
      user.string('email', 255);
      user.string('firstName', 255);
      user.string('lastName', 255);
      user.string('profilePicture', 255);
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('relations').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('relations', function (relation) {
      relation.increments('id').primary();
      relation.integer('user1id');
      relation.integer('user2id');
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('allRequests').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('allRequests', function (request) {
      request.increments('id').primary();
      request.string('requestor', 255);
      request.string('requestee', 255);
      request.string('requestTyp', 255);
      request.string('movie', 255);
      request.string('message', 255);
      request.string('response', 255);
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

module.exports = db;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9kYkNvbm5lY3Rpb24uanMiXSwibmFtZXMiOlsia25leCIsInJlcXVpcmUiLCJjbGllbnQiLCJjb25uZWN0aW9uIiwiaG9zdCIsInVzZXIiLCJwYXNzd29yZCIsImRhdGFiYXNlIiwiY2hhcnNldCIsImRiIiwic2NoZW1hIiwiaGFzVGFibGUiLCJ0aGVuIiwiZXhpc3RzIiwiY3JlYXRlVGFibGUiLCJtb3ZpZSIsImludGVnZXIiLCJwcmltYXJ5Iiwic3RyaW5nIiwicmF3IiwidGFibGUiLCJjb25zb2xlIiwibG9nIiwicmF0aW5nIiwiaW5jcmVtZW50cyIsInRpbWVzdGFtcHMiLCJ1bmlxdWUiLCJyZWxhdGlvbiIsInJlcXVlc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLE9BQU9DLFFBQVEsTUFBUixFQUFnQjtBQUN6QkMsVUFBUSxPQURpQjtBQUV6QkMsY0FBWTtBQUNWQyxVQUFXLFdBREQ7QUFFVkMsVUFBVyxNQUZEO0FBR1ZDLGNBQVcsT0FIRDtBQUlWQyxjQUFXLGNBSkQ7QUFLVkMsYUFBVzs7QUFMRDs7QUFTWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQnlCLENBQWhCLENBQVg7O0FBbUJBLElBQUlDLEtBQUtSLFFBQVEsV0FBUixFQUFxQkQsSUFBckIsQ0FBVDs7QUFFQVMsR0FBR1QsSUFBSCxDQUFRVSxNQUFSLENBQWVDLFFBQWYsQ0FBd0IsUUFBeEIsRUFBa0NDLElBQWxDLENBQXVDLFVBQVNDLE1BQVQsRUFBaUI7QUFDdEQsTUFBSSxDQUFDQSxNQUFMLEVBQWE7QUFDWEosT0FBR1QsSUFBSCxDQUFRVSxNQUFSLENBQWVJLFdBQWYsQ0FBMkIsUUFBM0IsRUFBcUMsVUFBVUMsS0FBVixFQUFpQjtBQUNwREEsWUFBTUMsT0FBTixDQUFjLElBQWQsRUFBb0JDLE9BQXBCO0FBQ0FGLFlBQU1HLE1BQU4sQ0FBYSxPQUFiLEVBQXNCLEdBQXRCO0FBQ0FILFlBQU1HLE1BQU4sQ0FBYSxP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eEIsRUFBdUNDLElBQXZDLENBQTRDLFVBQVNDLE1BQVQsRUFBaUI7QUFDM0QsTUFBSSxDQUFDQSxNQUFMLEVBQWE7QUFDWEosT0FBR1QsSUFBSCxDQUFRVSxNQUFSLENBQWVJLFdBQWYsQ0FBMkIsYUFBM0IsRUFBMEMsVUFBU2MsT0FBVCxFQUFrQjtBQUMxREEsY0FBUUosVUFBUixDQUFtQixJQUFuQixFQUF5QlAsT0FBekI7QUFDQVcsY0FBUVYsTUFBUixDQUFlLFdBQWYsRUFBNEIsR0FBNUI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFdBQWYsRUFBNEIsR0FBNUI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFlBQWYsRUFBNkIsR0FBN0I7QUFDQVUsY0FBUVYsTUFBUixDQUFlLE9BQWYsRUFBdUIsR0FBdkI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFNBQWYsRUFBMEIsR0FBMUI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFVBQWYsRUFBMkIsR0FBM0I7QUFDRCxLQVJELEVBUUdOLElBUkgsQ0FRUSxVQUFVUSxLQUFWLEVBQWlCO0FBQ3ZCQyxjQUFRQyxHQUFSLENBQVksZUFBWixFQUE2QkYsS0FBN0I7QUFDRCxLQVZEO0FBV0Q7QUFDRixDQWREOztBQWdCQVMsT0FBT0MsT0FBUCxHQUFpQnJCLEVBQWpCIiwiZmlsZSI6ImRiQ29ubmVjdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBrbmV4ID0gcmVxdWlyZSgna25leCcpKHtcclxuICBjbGllbnQ6ICdteXNxbCcsXHJcbiAgY29ubmVjdGlvbjoge1xyXG4gICAgaG9zdCAgICAgOiAnMTI3LjAuMC4xJyxcclxuICAgIHVzZXIgICAgIDogJ3Jvb3QnLFxyXG4gICAgcGFzc3dvcmQgOiAnMTIzNDUnLFxyXG4gICAgZGF0YWJhc2UgOiAnTWFpbkRhdGFiYXNlJyxcclxuICAgIGNoYXJzZXQgIDogJ3V0ZjgnXHJcblxyXG4gIH1cclxuXHJcbiAgLy8gY29ubmVjdGlvbjoge1xyXG4gIC8vICAgaG9zdCAgICAgOiAndXMtY2Rici1pcm9uLWVhc3QtMDQuY2xlYXJkYi5uZXQnLFxyXG4gIC8vICAgdXNlciAgICAgOiAnYjQxOTI4YWE5ZDZlM2MnLFxyXG4gIC8vICAgcGFzc3dvcmQgOiAnNWE3MjAwOWYnLFxyXG4gIC8vICAgZGF0YWJhc2UgOiAnaGVyb2t1Xzc1ZTRmZjI5NWMyNzU4ZCdcclxuICAvLyB9XHJcbn0pO1xyXG5cclxudmFyIGRiID0gcmVxdWlyZSgnYm9va3NoZWxmJykoa25leCk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgnbW92aWVzJykudGhlbihmdW5jdGlvbihleGlzdHMpIHtcclxuICBpZiAoIWV4aXN0cykge1xyXG4gICAgZGIua25leC5zY2hlbWEuY3JlYXRlVGFibGUoJ21vdmllcycsIGZ1bmN0aW9uIChtb3ZpZSkge1xyXG4gICAgICBtb3ZpZS5pbnRlZ2VyKCdpZCcpLnByaW1hcnkoKTtcclxuICAgICAgbW92aWUuc3RyaW5nKCd0aXRsZScsIDI1NSk7XHJcbiAgICAgIG1vdmllLnN0cmluZygnZ2VucmUnLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5zdHJpbmcoJ3Bvc3RlcicsIDI1NSk7XHJcbiAgICAgIG1vdmllLnN0cmluZygncmVsZWFzZV9kYXRlJywgMjU1KTtcclxuICAgICAgbW92aWUuc3RyaW5nKCdkZXNjcmlwdGlvbicsIDI1NSk7XHJcbiAgICAgIG1vdmllLmludGVnZXIoJ2ltZGJSYXRpbmcnKTtcclxuICAgIH0pXHJcbiAgICAucmF3KGBBTFRFUiBUQUJMRSBtb3ZpZXMgQUREIEZVTExURVhUICh0aXRsZSlgKVxyXG4gICAgLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmRiLmtuZXguc2NoZW1hLmhhc1RhYmxlKCdyYXRpbmdzJykudGhlbihmdW5jdGlvbihleGlzdHMpIHtcclxuICBpZiAoIWV4aXN0cykge1xyXG4gICAgZGIua25leC5zY2hlbWEuY3JlYXRlVGFibGUoJ3JhdGluZ3MnLCBmdW5jdGlvbiAocmF0aW5nKSB7XHJcbiAgICAgIHJhdGluZy5pbmNyZW1lbnRzKCdpZCcpLnByaW1hcnkoKTtcclxuICAgICAgcmF0aW5nLmludGVnZXIoJ3Njb3JlJyk7XHJcbiAgICAgIHJhdGluZy5pbnRlZ2VyKCdtb3ZpZWlkJyk7XHJcbiAgICAgIHJhdGluZy5pbnRlZ2VyKCd1c2VyaWQnKTtcclxuICAgICAgcmF0aW5nLnN0cmluZygncmV2aWV3JywgMjU1KTtcclxuICAgICAgcmF0aW5nLnRpbWVzdGFtcHMoKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmRiLmtuZXguc2NoZW1hLmhhc1RhYmxlKCd1c2VycycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCd1c2VycycsIGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgdXNlci5pbmNyZW1lbnRzKCdpZCcpLnByaW1hcnkoKTtcclxuICAgICAgdXNlci5zdHJpbmcoJ3VzZXJuYW1lJywgMjU1KS51bmlxdWUoKTtcclxuICAgICAgdXNlci5zdHJpbmcoJ3Bhc3N3b3JkJywgMjU1KTtcclxuICAgICAgdXNlci5zdHJpbmcoJ2VtYWlsJywgMjU1KTtcclxuICAgICAgdXNlci5zdHJpbmcoJ2ZpcnN0TmFtZScsIDI1NSk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdsYXN0TmFtZScsIDI1NSk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdwcm9maWxlUGljdHVyZScsIDI1NSk7XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uICh0YWJsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBUYWJsZScsIHRhYmxlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgncmVsYXRpb25zJykudGhlbihmdW5jdGlvbihleGlzdHMpIHtcclxuICBpZiAoIWV4aXN0cykge1xyXG4gICAgZGIua25leC5zY2hlbWEuY3JlYXRlVGFibGUoJ3JlbGF0aW9ucycsIGZ1bmN0aW9uKHJlbGF0aW9uKSB7XHJcbiAgICAgIHJlbGF0aW9uLmluY3JlbWVudHMoJ2lkJykucHJpbWFyeSgpO1xyXG4gICAgICByZWxhdGlvbi5pbnRlZ2VyKCd1c2VyMWlkJyk7XHJcbiAgICAgIHJlbGF0aW9uLmludGVnZXIoJ3VzZXIyaWQnKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmRiLmtuZXguc2NoZW1hLmhhc1RhYmxlKCdhbGxSZXF1ZXN0cycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdhbGxSZXF1ZXN0cycsIGZ1bmN0aW9uKHJlcXVlc3QpIHtcclxuICAgICAgcmVxdWVzdC5pbmNyZW1lbnRzKCdpZCcpLnByaW1hcnkoKTtcclxuICAgICAgcmVxdWVzdC5zdHJpbmcoJ3JlcXVlc3RvcicsIDI1NSk7XHJcbiAgICAgIHJlcXVlc3Quc3RyaW5nKCdyZXF1ZXN0ZWUnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnN0cmluZygncmVxdWVzdFR5cCcsIDI1NSk7XHJcbiAgICAgIHJlcXVlc3Quc3RyaW5nKCdtb3ZpZScsMjU1KTtcclxuICAgICAgcmVxdWVzdC5zdHJpbmcoJ21lc3NhZ2UnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnN0cmluZygncmVzcG9uc2UnLCAyNTUpO1xyXG4gICAgfSkudGhlbihmdW5jdGlvbiAodGFibGUpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgVGFibGUnLCB0YWJsZSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBkYjtcclxuXHJcblxyXG5cclxuIl19