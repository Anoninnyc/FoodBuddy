'use strict';

var knex = require('knex')({
  client: 'mysql',
  connection: {
    host: "us-cdbr-iron-east-04.cleardb.net",
    user: 'b6e72659e4f62e',
    password: '4b75d43f',
    database: 'heroku_8743521ae68d583',
    charset: 'utf8'
  },
  pool: { min: 0, max: 6 }
}),
    db = require('bookshelf')(knex);

//
db.knex.schema.hasTable('movies').then(function (a) {
  if (!a) {
    db.knex.schema.createTable('movies', function (b) {
      b.integer('id').primary();
      b.string('title', 255);
      b.string('genre', 255);
      b.string('poster', 255);
      b.string('release_date', 255);
      b.string('description', 255);
      b.integer('imdbRating');
    }).raw('ALTER TABLE movies ADD FULLTEXT (title)').then(function (b) {});
  }
});

db.knex.schema.hasTable('ratings').then(function (a) {
  if (!a) {
    db.knex.schema.createTable('ratings', function (b) {
      b.increments('id').primary();
      b.integer('score');
      b.integer('movieid');
      b.integer('userid');
      b.string('review', 255);
      b.timestamps();
    }).then(function (b) {});
  }
});

db.knex.schema.hasTable('users').then(function (a) {
  if (!a) {
    db.knex.schema.createTable('users', function (b) {
      b.increments('id').primary();
      b.string('username', 255).unique();
      b.string('password', 255);
      b.string('email', 255);
      b.string('firstName', 255);
      b.string('lastName', 255);
      b.string('profilePicture', 255);
    }).then(function (b) {});
  } //
});

db.knex.schema.hasTable('relations').then(function (a) {
  if (!a) {
    db.knex.schema.createTable('relations', function (b) {
      b.increments('id').primary();
      b.integer('user1id');
      b.integer('user2id');
    }).then(function (b) {});
  }
});

db.knex.schema.hasTable('allRequests').then(function (a) {
  if (!a) {
    db.knex.schema.createTable('allRequests', function (b) {
      b.increments('id').primary();
      b.string('requestor', 255);
      b.string('requestee', 255);
      b.string('requestTyp', 255);
      b.string('movie', 255);
      b.string('message', 255);
      b.string('response', 255);
      b.timestamps();
    }).then(function (b) {});
  }
});

module.exports = db;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9kYkNvbm5lY3Rpb24uanMiXSwibmFtZXMiOlsia25leCIsInJlcXVpcmUiLCJjbGllbnQiLCJjb25uZWN0aW9uIiwiaG9zdCIsInVzZXIiLCJwYXNzd29yZCIsImRhdGFiYXNlIiwiY2hhcnNldCIsInBvb2wiLCJtaW4iLCJtYXgiLCJkYiIsInNjaGVtYSIsImhhc1RhYmxlIiwidGhlbiIsImV4aXN0cyIsImNyZWF0ZVRhYmxlIiwibW92aWUiLCJpbnRlZ2VyIiwicHJpbWFyeSIsInN0cmluZyIsInJhdyIsInRhYmxlIiwicmF0aW5nIiwiaW5jcmVtZW50cyIsInRpbWVzdGFtcHMiLCJ1bmlxdWUiLCJyZWxhdGlvbiIsInJlcXVlc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLE9BQU9DLFFBQVEsTUFBUixFQUFnQjtBQUN6QkMsVUFBUSxPQURpQjtBQUV6QkMsY0FBWTtBQUNWQyxVQUFNLGtDQURJO0FBRVZDLFVBQU0sZ0JBRkk7QUFHVkMsY0FBVyxVQUhEO0FBSVZDLGNBQVUsd0JBSkE7QUFLVkMsYUFBVztBQUxELEdBRmE7QUFTekJDLFFBQU0sRUFBRUMsS0FBSyxDQUFQLEVBQVVDLEtBQUssQ0FBZjtBQVRtQixDQUFoQixDQUFYO0FBQUEsSUFZSUMsS0FBS1gsUUFBUSxXQUFSLEVBQXFCRCxJQUFyQixDQVpUOztBQWFBO0FBQ0FZLEdBQUdaLElBQUgsQ0FBUWEsTUFBUixDQUFlQyxRQUFmLENBQXdCLFFBQXhCLEVBQWtDQyxJQUFsQyxDQUF1QyxVQUFTQyxDQUFULEVBQWlCO0FBQ3RELE1BQUksQ0FBQ0EsQ0FBTCxFQUFhO0FBQ1hKLE9BQUdaLElBQUgsQ0FBUWEsTUFBUixDQUFlSSxXQUFmLENBQTJCLFFBQTNCLEVBQXFDLFVBQVVDLENBQVYsRUFBaUI7QUFDcERBLFFBQU1DLE9BQU4sQ0FBYyxJQUFkLEVBQW9CQyxPQUFwQjtBQUNBRixRQUFNRyxNQUFOLENBQWEsT0FBYixFQUFzQixHQUF0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QTNCLEVBQTBDLFVBQVNZLENBQVQsRUFBa0I7QUFDMURBLFFBQVFKLFVBQVIsQ0FBbUIsSUFBbkIsRUFBeUJMLE9BQXpCO0FBQ0FTLFFBQVFSLE1BQVIsQ0FBZSxXQUFmLEVBQTRCLEdBQTVCO0FBQ0FRLFFBQVFSLE1BQVIsQ0FBZSxXQUFmLEVBQTRCLEdBQTVCO0FBQ0FRLFFBQVFSLE1BQVIsQ0FBZSxZQUFmLEVBQTZCLEdBQTdCO0FBQ0FRLFFBQVFSLE1BQVIsQ0FBZSxPQUFmLEVBQXVCLEdBQXZCO0FBQ0FRLFFBQVFSLE1BQVIsQ0FBZSxTQUFmLEVBQTBCLEdBQTFCO0FBQ0FRLFFBQVFSLE1BQVIsQ0FBZSxVQUFmLEVBQTJCLEdBQTNCO0FBQ0FRLFFBQVFILFVBQVI7QUFDRCxLQVRELEVBU0dYLElBVEgsQ0FTUSxVQUFVUSxDQUFWLEVBQWlCLENBRXhCLENBWEQ7QUFZRDtBQUNGLENBZkQ7O0FBaUJBTyxPQUFPQyxPQUFQLEdBQWlCbkIsRUFBakIiLCJmaWxlIjoiZGJDb25uZWN0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGtuZXggPSByZXF1aXJlKCdrbmV4Jykoe1xyXG4gIGNsaWVudDogJ215c3FsJyxcclxuICBjb25uZWN0aW9uOiB7XHJcbiAgICBob3N0OiBcInVzLWNkYnItaXJvbi1lYXN0LTA0LmNsZWFyZGIubmV0XCIsXHJcbiAgICB1c2VyOiAnYjZlNzI2NTllNGY2MmUnLFxyXG4gICAgcGFzc3dvcmQ6ICAnNGI3NWQ0M2YnLFxyXG4gICAgZGF0YWJhc2U6ICdoZXJva3VfODc0MzUyMWFlNjhkNTgzJyxcclxuICAgIGNoYXJzZXQgIDogJ3V0ZjgnXHJcbiAgfSxcclxuICBwb29sOiB7IG1pbjogMCwgbWF4OiA2IH1cclxufSk7XHJcblxyXG52YXIgZGIgPSByZXF1aXJlKCdib29rc2hlbGYnKShrbmV4KTtcclxuLy9cclxuZGIua25leC5zY2hlbWEuaGFzVGFibGUoJ21vdmllcycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdtb3ZpZXMnLCBmdW5jdGlvbiAobW92aWUpIHtcclxuICAgICAgbW92aWUuaW50ZWdlcignaWQnKS5wcmltYXJ5KCk7XHJcbiAgICAgIG1vdmllLnN0cmluZygndGl0bGUnLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5zdHJpbmcoJ2dlbnJlJywgMjU1KTtcclxuICAgICAgbW92aWUuc3RyaW5nKCdwb3N0ZXInLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5zdHJpbmcoJ3JlbGVhc2VfZGF0ZScsIDI1NSk7XHJcbiAgICAgIG1vdmllLnN0cmluZygnZGVzY3JpcHRpb24nLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5pbnRlZ2VyKCdpbWRiUmF0aW5nJyk7XHJcbiAgICB9KVxyXG4gICAgLnJhdyhgQUxURVIgVEFCTEUgbW92aWVzIEFERCBGVUxMVEVYVCAodGl0bGUpYClcclxuICAgIC50aGVuKGZ1bmN0aW9uICh0YWJsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBUYWJsZScsIHRhYmxlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgncmF0aW5ncycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdyYXRpbmdzJywgZnVuY3Rpb24gKHJhdGluZykge1xyXG4gICAgICByYXRpbmcuaW5jcmVtZW50cygnaWQnKS5wcmltYXJ5KCk7XHJcbiAgICAgIHJhdGluZy5pbnRlZ2VyKCdzY29yZScpO1xyXG4gICAgICByYXRpbmcuaW50ZWdlcignbW92aWVpZCcpO1xyXG4gICAgICByYXRpbmcuaW50ZWdlcigndXNlcmlkJyk7XHJcbiAgICAgIHJhdGluZy5zdHJpbmcoJ3JldmlldycsIDI1NSk7XHJcbiAgICAgIHJhdGluZy50aW1lc3RhbXBzKCk7XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uICh0YWJsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBUYWJsZScsIHRhYmxlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgndXNlcnMnKS50aGVuKGZ1bmN0aW9uKGV4aXN0cykge1xyXG4gIGlmICghZXhpc3RzKSB7XHJcbiAgICBkYi5rbmV4LnNjaGVtYS5jcmVhdGVUYWJsZSgndXNlcnMnLCBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgIHVzZXIuaW5jcmVtZW50cygnaWQnKS5wcmltYXJ5KCk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCd1c2VybmFtZScsIDI1NSkudW5pcXVlKCk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdwYXNzd29yZCcsIDI1NSk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdlbWFpbCcsIDI1NSk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdmaXJzdE5hbWUnLCAyNTUpO1xyXG4gICAgICB1c2VyLnN0cmluZygnbGFzdE5hbWUnLCAyNTUpO1xyXG4gICAgICB1c2VyLnN0cmluZygncHJvZmlsZVBpY3R1cmUnLCAyNTUpO1xyXG4gICAgfSkudGhlbihmdW5jdGlvbiAodGFibGUpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgVGFibGUnLCB0YWJsZSk7XHJcbiAgICB9KTtcclxuICB9Ly9cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgncmVsYXRpb25zJykudGhlbihmdW5jdGlvbihleGlzdHMpIHtcclxuICBpZiAoIWV4aXN0cykge1xyXG4gICAgZGIua25leC5zY2hlbWEuY3JlYXRlVGFibGUoJ3JlbGF0aW9ucycsIGZ1bmN0aW9uKHJlbGF0aW9uKSB7XHJcbiAgICAgIHJlbGF0aW9uLmluY3JlbWVudHMoJ2lkJykucHJpbWFyeSgpO1xyXG4gICAgICByZWxhdGlvbi5pbnRlZ2VyKCd1c2VyMWlkJyk7XHJcbiAgICAgIHJlbGF0aW9uLmludGVnZXIoJ3VzZXIyaWQnKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmRiLmtuZXguc2NoZW1hLmhhc1RhYmxlKCdhbGxSZXF1ZXN0cycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdhbGxSZXF1ZXN0cycsIGZ1bmN0aW9uKHJlcXVlc3QpIHtcclxuICAgICAgcmVxdWVzdC5pbmNyZW1lbnRzKCdpZCcpLnByaW1hcnkoKTtcclxuICAgICAgcmVxdWVzdC5zdHJpbmcoJ3JlcXVlc3RvcicsIDI1NSk7XHJcbiAgICAgIHJlcXVlc3Quc3RyaW5nKCdyZXF1ZXN0ZWUnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnN0cmluZygncmVxdWVzdFR5cCcsIDI1NSk7XHJcbiAgICAgIHJlcXVlc3Quc3RyaW5nKCdtb3ZpZScsMjU1KTtcclxuICAgICAgcmVxdWVzdC5zdHJpbmcoJ21lc3NhZ2UnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnN0cmluZygncmVzcG9uc2UnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnRpbWVzdGFtcHMoKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZGI7XHJcblxyXG5cclxuXHJcbiJdfQ==