'use strict';

var knex = require('knex')({
  client: 'mysql',
  connection: {
    host: "us-cdbr-iron-east-04.cleardb.net",
    user: 'b6e72659e4f62e',
    password: '4b75d43f',
    database: 'heroku_8743521ae68d583',
    charset: 'utf8'
  },
  pool: { min: 0, max: 6 }
});

var db = require('bookshelf')(knex);
//
db.knex.schema.hasTable('movies').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('movies', function (movie) {
      movie.integer('id').primary();
      movie.string('title', 255);
      movie.string('genre', 255);
      movie.string('poster', 255);
      movie.string('release_date', 255);
      movie.string('description', 255);
      movie.integer('imdbRating');
    }).raw('ALTER TABLE movies ADD FULLTEXT (title)').then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('ratings').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('ratings', function (rating) {
      rating.increments('id').primary();
      rating.integer('score');
      rating.integer('movieid');
      rating.integer('userid');
      rating.string('review', 255);
      rating.timestamps();
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('users').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('users', function (user) {
      user.increments('id').primary();
      user.string('username', 255).unique();
      user.string('password', 255);
      user.string('email', 255);
      user.string('firstName', 255);
      user.string('lastName', 255);
      user.string('profilePicture', 255);
    }).then(function (table) {
      console.log('Created Table', table);
    });
  } //
});

db.knex.schema.hasTable('relations').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('relations', function (relation) {
      relation.increments('id').primary();
      relation.integer('user1id');
      relation.integer('user2id');
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

db.knex.schema.hasTable('allRequests').then(function (exists) {
  if (!exists) {
    db.knex.schema.createTable('allRequests', function (request) {
      request.increments('id').primary();
      request.string('requestor', 255);
      request.string('requestee', 255);
      request.string('requestTyp', 255);
      request.string('movie', 255);
      request.string('message', 255);
      request.string('response', 255);
      request.timestamps();
    }).then(function (table) {
      console.log('Created Table', table);
    });
  }
});

module.exports = db;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9kYkNvbm5lY3Rpb24uanMiXSwibmFtZXMiOlsia25leCIsInJlcXVpcmUiLCJjbGllbnQiLCJjb25uZWN0aW9uIiwiaG9zdCIsInVzZXIiLCJwYXNzd29yZCIsImRhdGFiYXNlIiwiY2hhcnNldCIsInBvb2wiLCJtaW4iLCJtYXgiLCJkYiIsInNjaGVtYSIsImhhc1RhYmxlIiwidGhlbiIsImV4aXN0cyIsImNyZWF0ZVRhYmxlIiwibW92aWUiLCJpbnRlZ2VyIiwicHJpbWFyeSIsInN0cmluZyIsInJhdyIsInRhYmxlIiwiY29uc29sZSIsImxvZyIsInJhdGluZyIsImluY3JlbWVudHMiLCJ0aW1lc3RhbXBzIiwidW5pcXVlIiwicmVsYXRpb24iLCJyZXF1ZXN0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxPQUFPQyxRQUFRLE1BQVIsRUFBZ0I7QUFDekJDLFVBQVEsT0FEaUI7QUFFekJDLGNBQVk7QUFDVkMsVUFBTSxrQ0FESTtBQUVWQyxVQUFNLGdCQUZJO0FBR1ZDLGNBQVcsVUFIRDtBQUlWQyxjQUFVLHdCQUpBO0FBS1ZDLGFBQVc7QUFMRCxHQUZhO0FBU3pCQyxRQUFNLEVBQUVDLEtBQUssQ0FBUCxFQUFVQyxLQUFLLENBQWY7QUFUbUIsQ0FBaEIsQ0FBWDs7QUFZQSxJQUFJQyxLQUFLWCxRQUFRLFdBQVIsRUFBcUJELElBQXJCLENBQVQ7QUFDQTtBQUNBWSxHQUFHWixJQUFILENBQVFhLE1BQVIsQ0FBZUMsUUFBZixDQUF3QixRQUF4QixFQUFrQ0MsSUFBbEMsQ0FBdUMsVUFBU0MsTUFBVCxFQUFpQjtBQUN0RCxNQUFJLENBQUNBLE1BQUwsRUFBYTtBQUNYSixPQUFHWixJQUFILENBQVFhLE1BQVIsQ0FBZUksV0FBZixDQUEyQixRQUEzQixFQUFxQyxVQUFVQyxLQUFWLEVBQWlCO0FBQ3BEQSxZQUFNQyxPQUFOLENBQWMsSUFBZCxFQUFvQkMsT0FBcEI7QUFDQUYsWUFBTUcsTUFBTixDQUFhLE9BQWIsRUFBc0IsR0FBdEI7QUFDQUgsWUFBTUcsTUFBTixDQUFhLE9BQWIsRUFBc0IsR0FBdEI7QUFDQUgsWUFBTUcsTUFBTixDQUFhLFFBQWIsRUFBdUIsR0FBdkI7QUFDQUgsWUFBTUcsTUFBTixDQUFhLGNBQWIsRUFBNkIsR0FBN0I7QUFDQUgsWUFBTUcsTUFBTixDQUFhLGFBQWIsRUFBNEIsR0FBNUI7QUFDQUgsWUFBTUMsT0FBTixDQUFjLFlBQWQ7QUFDRCxLQVJELEVBU0NHLEdBVEQsNENBVUNQLElBVkQsQ0FVTSxVQUFVUSxLQUFWLEVBQWlCO0FBQ3JCQyxjQUFRQyxHQUFSLENBQVksZUFBWixFQUE2QkYsS0FBN0I7QUFDRCxLQVpEO0FBYUQ7QUFDRixDQWhCRDs7QUFrQkFYLEdBQUdaLElBQUgsQ0FBUWEsTUFBUixDQUFlQyxRQUFmLENBQXdCLFNBQXhCLEVBQW1DQyxJQUFuQyxDQUF3QyxVQUFTQyxNQUFULEVBQWlCO0FBQ3ZELE1BQUksQ0FBQ0EsTUFBTCxFQUFhO0FBQ1hKLE9BQUdaLElBQUgsQ0FBUWEsTUFBUixDQUFlSSxXQUFmLENBQTJCLFNBQTNCLEVBQXNDLFVBQVVTLE1BQVYsRUFBa0I7QUFDdERBLGFBQU9DLFVBQVAsQ0FBa0IsSUFBbEIsRUFBd0JQLE9BQXhCO0FBQ0FNLGFBQU9QLE9BQVAsQ0FBZSxPQUFmO0FBQ0FPLGFBQU9QLE9BQVAsQ0FBZSxTQUFmO0FBQ0FPLGFBQU9QLE9BQVAsQ0FBZSxRQUFmO0FBQ0FPLGFBQU9MLE1BQVAsQ0FBYyxRQUFkLEVBQXdCLEdBQXhCO0FBQ0FLLGFBQU9FLFVBQVA7QUFDRCxLQVBELEVBT0diLElBUEgsQ0FPUSxVQUFVUSxLQUFWLEVBQWlCO0FBQ3ZCQyxjQUFRQyxHQUFSLENBQVksZUFBWixFQUE2QkYsS0FBN0I7QUFDRCxLQVREO0FBVUQ7QUFDRixDQWJEOztBQWVBWCxHQUFHWixJQUFILENBQVFhLE1BQVIsQ0FBZUMsUUFBZixDQUF3QixPQUF4QixFQUFpQ0MsSUFBakMsQ0FBc0MsVUFBU0MsTUFBVCxFQUFpQjtBQUNyRCxNQUFJLENBQUNBLE1BQUwsRUFBYTtBQUNYSixPQUFHWixJQUFILENBQVFhLE1BQVIsQ0FBZUksV0FBZixDQUEyQixPQUEzQixFQUFvQyxVQUFTWixJQUFULEVBQWU7QUFDakRBLFdBQUtzQixVQUFMLENBQWdCLElBQWhCLEVBQXNCUCxPQUF0QjtBQUNBZixXQUFLZ0IsTUFBTCxDQUFZLFVBQVosRUFBd0IsR0FBeEIsRUFBNkJRLE1BQTdCO0FBQ0F4QixXQUFLZ0IsTUFBTCxDQUFZLFVBQVosRUFBd0IsR0FBeEI7QUFDQWhCLFdBQUtnQixNQUFMLENBQVksT0FBWixFQUFxQixHQUFyQjtBQUNBaEIsV0FBS2dCLE1BQUwsQ0FBWSxXQUFaLEVBQXlCLEdBQXpCO0FBQ0FoQixXQUFLZ0IsTUFBTCxDQUFZLFVBQVosRUFBd0IsR0FBeEI7QUFDQWhCLFdBQUtnQixNQUFMLENBQVksZ0JBQVosRUFBOEIsR0FBOUI7QUFDRCxLQVJELEVBUUdOLElBUkgsQ0FRUSxVQUFVUSxLQUFWLEVBQWlCO0FBQ3ZCQyxjQUFRQyxHQUFSLENBQVksZUFBWixFQUE2QkYsS0FBN0I7QUFDRCxLQVZEO0FBV0QsR0Fib0QsQ0FhcEQ7QUFDRixDQWREOztBQWdCQVgsR0FBR1osSUFBSCxDQUFRYSxNQUFSLENBQWVDLFFBQWYsQ0FBd0IsV0FBeEIsRUFBcUNDLElBQXJDLENBQTBDLFVBQVNDLE1BQVQsRUFBaUI7QUFDekQsTUFBSSxDQUFDQSxNQUFMLEVBQWE7QUFDWEosT0FBR1osSUFBSCxDQUFRYSxNQUFSLENBQWVJLFdBQWYsQ0FBMkIsV0FBM0IsRUFBd0MsVUFBU2EsUUFBVCxFQUFtQjtBQUN6REEsZUFBU0gsVUFBVCxDQUFvQixJQUFwQixFQUEwQlAsT0FBMUI7QUFDQVUsZUFBU1gsT0FBVCxDQUFpQixTQUFqQjtBQUNBVyxlQUFTWCxPQUFULENBQWlCLFNBQWpCO0FBQ0QsS0FKRCxFQUlHSixJQUpILENBSVEsVUFBVVEsS0FBVixFQUFpQjtBQUN2QkMsY0FBUUMsR0FBUixDQUFZLGVBQVosRUFBNkJGLEtBQTdCO0FBQ0QsS0FORDtBQU9EO0FBQ0YsQ0FWRDs7QUFZQVgsR0FBR1osSUFBSCxDQUFRYSxNQUFSLENBQWVDLFFBQWYsQ0FBd0IsYUFBeEIsRUFBdUNDLElBQXZDLENBQTRDLFVBQVNDLE1BQVQsRUFBaUI7QUFDM0QsTUFBSSxDQUFDQSxNQUFMLEVBQWE7QUFDWEosT0FBR1osSUFBSCxDQUFRYSxNQUFSLENBQWVJLFdBQWYsQ0FBMkIsYUFBM0IsRUFBMEMsVUFBU2MsT0FBVCxFQUFrQjtBQUMxREEsY0FBUUosVUFBUixDQUFtQixJQUFuQixFQUF5QlAsT0FBekI7QUFDQVcsY0FBUVYsTUFBUixDQUFlLFdBQWYsRUFBNEIsR0FBNUI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFdBQWYsRUFBNEIsR0FBNUI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFlBQWYsRUFBNkIsR0FBN0I7QUFDQVUsY0FBUVYsTUFBUixDQUFlLE9BQWYsRUFBdUIsR0FBdkI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFNBQWYsRUFBMEIsR0FBMUI7QUFDQVUsY0FBUVYsTUFBUixDQUFlLFVBQWYsRUFBMkIsR0FBM0I7QUFDQVUsY0FBUUgsVUFBUjtBQUNELEtBVEQsRUFTR2IsSUFUSCxDQVNRLFVBQVVRLEtBQVYsRUFBaUI7QUFDdkJDLGNBQVFDLEdBQVIsQ0FBWSxlQUFaLEVBQTZCRixLQUE3QjtBQUNELEtBWEQ7QUFZRDtBQUNGLENBZkQ7O0FBaUJBUyxPQUFPQyxPQUFQLEdBQWlCckIsRUFBakIiLCJmaWxlIjoiZGJDb25uZWN0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGtuZXggPSByZXF1aXJlKCdrbmV4Jykoe1xyXG4gIGNsaWVudDogJ215c3FsJyxcclxuICBjb25uZWN0aW9uOiB7XHJcbiAgICBob3N0OiBcInVzLWNkYnItaXJvbi1lYXN0LTA0LmNsZWFyZGIubmV0XCIsXHJcbiAgICB1c2VyOiAnYjZlNzI2NTllNGY2MmUnLFxyXG4gICAgcGFzc3dvcmQ6ICAnNGI3NWQ0M2YnLFxyXG4gICAgZGF0YWJhc2U6ICdoZXJva3VfODc0MzUyMWFlNjhkNTgzJyxcclxuICAgIGNoYXJzZXQgIDogJ3V0ZjgnXHJcbiAgfSxcclxuICBwb29sOiB7IG1pbjogMCwgbWF4OiA2IH1cclxufSk7XHJcblxyXG52YXIgZGIgPSByZXF1aXJlKCdib29rc2hlbGYnKShrbmV4KTtcclxuLy9cclxuZGIua25leC5zY2hlbWEuaGFzVGFibGUoJ21vdmllcycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdtb3ZpZXMnLCBmdW5jdGlvbiAobW92aWUpIHtcclxuICAgICAgbW92aWUuaW50ZWdlcignaWQnKS5wcmltYXJ5KCk7XHJcbiAgICAgIG1vdmllLnN0cmluZygndGl0bGUnLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5zdHJpbmcoJ2dlbnJlJywgMjU1KTtcclxuICAgICAgbW92aWUuc3RyaW5nKCdwb3N0ZXInLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5zdHJpbmcoJ3JlbGVhc2VfZGF0ZScsIDI1NSk7XHJcbiAgICAgIG1vdmllLnN0cmluZygnZGVzY3JpcHRpb24nLCAyNTUpO1xyXG4gICAgICBtb3ZpZS5pbnRlZ2VyKCdpbWRiUmF0aW5nJyk7XHJcbiAgICB9KVxyXG4gICAgLnJhdyhgQUxURVIgVEFCTEUgbW92aWVzIEFERCBGVUxMVEVYVCAodGl0bGUpYClcclxuICAgIC50aGVuKGZ1bmN0aW9uICh0YWJsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBUYWJsZScsIHRhYmxlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgncmF0aW5ncycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdyYXRpbmdzJywgZnVuY3Rpb24gKHJhdGluZykge1xyXG4gICAgICByYXRpbmcuaW5jcmVtZW50cygnaWQnKS5wcmltYXJ5KCk7XHJcbiAgICAgIHJhdGluZy5pbnRlZ2VyKCdzY29yZScpO1xyXG4gICAgICByYXRpbmcuaW50ZWdlcignbW92aWVpZCcpO1xyXG4gICAgICByYXRpbmcuaW50ZWdlcigndXNlcmlkJyk7XHJcbiAgICAgIHJhdGluZy5zdHJpbmcoJ3JldmlldycsIDI1NSk7XHJcbiAgICAgIHJhdGluZy50aW1lc3RhbXBzKCk7XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uICh0YWJsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBUYWJsZScsIHRhYmxlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgndXNlcnMnKS50aGVuKGZ1bmN0aW9uKGV4aXN0cykge1xyXG4gIGlmICghZXhpc3RzKSB7XHJcbiAgICBkYi5rbmV4LnNjaGVtYS5jcmVhdGVUYWJsZSgndXNlcnMnLCBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgIHVzZXIuaW5jcmVtZW50cygnaWQnKS5wcmltYXJ5KCk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCd1c2VybmFtZScsIDI1NSkudW5pcXVlKCk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdwYXNzd29yZCcsIDI1NSk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdlbWFpbCcsIDI1NSk7XHJcbiAgICAgIHVzZXIuc3RyaW5nKCdmaXJzdE5hbWUnLCAyNTUpO1xyXG4gICAgICB1c2VyLnN0cmluZygnbGFzdE5hbWUnLCAyNTUpO1xyXG4gICAgICB1c2VyLnN0cmluZygncHJvZmlsZVBpY3R1cmUnLCAyNTUpO1xyXG4gICAgfSkudGhlbihmdW5jdGlvbiAodGFibGUpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgVGFibGUnLCB0YWJsZSk7XHJcbiAgICB9KTtcclxuICB9Ly9cclxufSk7XHJcblxyXG5kYi5rbmV4LnNjaGVtYS5oYXNUYWJsZSgncmVsYXRpb25zJykudGhlbihmdW5jdGlvbihleGlzdHMpIHtcclxuICBpZiAoIWV4aXN0cykge1xyXG4gICAgZGIua25leC5zY2hlbWEuY3JlYXRlVGFibGUoJ3JlbGF0aW9ucycsIGZ1bmN0aW9uKHJlbGF0aW9uKSB7XHJcbiAgICAgIHJlbGF0aW9uLmluY3JlbWVudHMoJ2lkJykucHJpbWFyeSgpO1xyXG4gICAgICByZWxhdGlvbi5pbnRlZ2VyKCd1c2VyMWlkJyk7XHJcbiAgICAgIHJlbGF0aW9uLmludGVnZXIoJ3VzZXIyaWQnKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmRiLmtuZXguc2NoZW1hLmhhc1RhYmxlKCdhbGxSZXF1ZXN0cycpLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XHJcbiAgaWYgKCFleGlzdHMpIHtcclxuICAgIGRiLmtuZXguc2NoZW1hLmNyZWF0ZVRhYmxlKCdhbGxSZXF1ZXN0cycsIGZ1bmN0aW9uKHJlcXVlc3QpIHtcclxuICAgICAgcmVxdWVzdC5pbmNyZW1lbnRzKCdpZCcpLnByaW1hcnkoKTtcclxuICAgICAgcmVxdWVzdC5zdHJpbmcoJ3JlcXVlc3RvcicsIDI1NSk7XHJcbiAgICAgIHJlcXVlc3Quc3RyaW5nKCdyZXF1ZXN0ZWUnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnN0cmluZygncmVxdWVzdFR5cCcsIDI1NSk7XHJcbiAgICAgIHJlcXVlc3Quc3RyaW5nKCdtb3ZpZScsMjU1KTtcclxuICAgICAgcmVxdWVzdC5zdHJpbmcoJ21lc3NhZ2UnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnN0cmluZygncmVzcG9uc2UnLCAyNTUpO1xyXG4gICAgICByZXF1ZXN0LnRpbWVzdGFtcHMoKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIFRhYmxlJywgdGFibGUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZGI7XHJcblxyXG5cclxuXHJcbiJdfQ==